<?xml version="1.0"?>

<PropertyList>
 

 <fdm>
  <jsbsim>
  <simulation>
   	<gravitational-torque type="bool">true</gravitational-torque>
  </simulation>
  <systems>
    	<orbital>
		<gm type="float">14.07644180e15</gm>
		<semimajor-axis-length-ft type="float">0.0</semimajor-axis-length-ft>
		<eccentricity type="float">0.0</eccentricity>
		<apoapsis-ft type="float">0.0</apoapsis-ft>
		<apoapsis-km type="float">0.0</apoapsis-km>
		<apoapsis-indicated-km type="float">0.0</apoapsis-indicated-km>
		<apoapsis-hunderds-km type="float">0.0</apoapsis-hunderds-km>
		<apoapsis-tens-km type="float">0.0</apoapsis-tens-km>
		<apoapsis-ones-km type="float">0.0</apoapsis-ones-km>
		<periapsis-ft type="float">0.0</periapsis-ft>
		<periapsis-km type="float">0.0</periapsis-km>
		<periapsis-indicated-km type="float">0.0</periapsis-indicated-km>
		<periapsis-hunderds-km type="float">0.0</periapsis-hunderds-km>
		<periapsis-tens-km type="float">0.0</periapsis-tens-km>
		<periapsis-ones-km type="float">0.0</periapsis-ones-km>
	</orbital>
	<fcs>
		<parachute_reef_pos_norm type="float"> 0 </parachute_reef_pos_norm>
		<control-mode type="int"> 0 </control-mode>
		<rcs-pitch-mode type="int">1</rcs-pitch-mode>
		<rcs-roll-mode type="int">1</rcs-roll-mode>
		<rcs-yaw-mode type="int">1</rcs-yaw-mode>
	</fcs>
	<rcs>
		<pod1-up-fire-roll type="float">0.0</pod1-up-fire-roll>
		<pod1-up-raw-pitch type="float">0.0</pod1-up-raw-pitch>
		<pod1-up-raw-roll type="float">0.0</pod1-up-raw-roll>
		<pod1-up-raw type="float">0.0</pod1-up-raw>
		<thrust-pod1-up type="float">0.0</thrust-pod1-up>

		<pod2-up-fire-roll type="float">0.0</pod2-up-fire-roll>
		<pod2-up-raw-pitch type="float">0.0</pod2-up-raw-pitch>
		<pod2-up-raw-roll type="float">0.0</pod2-up-raw-roll>
		<pod2-up-raw type="float">0.0</pod2-up-raw>
		<thrust-pod2-up type="float">0.0</thrust-pod2-up>

		<pod1-down-fire-roll type="float">0.0</pod1-down-fire-roll>
		<pod1-down-raw-pitch type="float">0.0</pod1-down-raw-pitch>
		<pod1-down-raw-roll type="float">0.0</pod1-down-raw-roll>
		<pod1-down-raw type="float">0.0</pod1-down-raw>
		<thrust-pod1-down type="float">0.0</thrust-pod1-down>

		<pod2-down-fire-roll type="float">0.0</pod2-down-fire-roll>
		<pod2-down-raw-pitch type="float">0.0</pod2-down-raw-pitch>
		<pod2-down-raw-roll type="float">0.0</pod2-down-raw-roll>
		<pod2-down-raw type="float">0.0</pod2-down-raw>
		<thrust-pod2-down type="float">0.0</thrust-pod2-down>

		<nose-up-fire-roll type="float">0.0</nose-up-fire-roll>
		<nose-up-raw-pitch type="float">0.0</nose-up-raw-pitch>
		<nose-up-raw-roll type="float">0.0</nose-up-raw-roll>
		<nose-up-raw type="float">0.0</nose-up-raw>
		<thrust-nose-up type="float">0.0</thrust-nose-up>

		<nose-down-fire-roll type="float">0.0</nose-down-fire-roll>
		<nose-down-raw-pitch type="float">0.0</nose-down-raw-pitch>
		<nose-down-raw-roll type="float">0.0</nose-down-raw-roll>
		<nose-down-raw type="float">0.0</nose-down-raw>
		<thrust-nose-down type="float">0.0</thrust-nose-down>

		<thrust-normalizer type="float">0.0</thrust-normalizer>
	</rcs>
  </systems>
  </jsbsim>
  </fdm>  



 <controls>    
    <shuttle>
       <external-fuel-tank type="int">1</external-fuel-tank>
       <solid-rocket-boosters type="int">1</solid-rocket-boosters>
       <outerspace type="bool">1</outerspace>
       <EMU type="int">0</EMU>
       <robotarm type="float">0</robotarm> 
       <door>
        	<position type="float">0</position>
      </door>
      <parachute type="int">0</parachute>
      <control-system-string type="string">Thrust Vectoring</control-system-string>
      <hud-mode>0</hud-mode>
      <gear-string>up</gear-string>
      <speedbrake-string>in</speedbrake-string>
      <drag-chute-string>in</drag-chute-string>
    </shuttle>
    
    <lighting>
       <nav-lights type="bool">1</nav-lights>
    </lighting>
    
    <armament>
      <trigger type="int">0</trigger>
    </armament>
    <engines>
      <engine n="0">
	<status-hud type="string">O</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
      <engine n="1">
	<status-hud type="string">O</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
      <engine n="2">
	<status-hud type="string">O</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
      <engine n="3">
	<status-hud type="string">O</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
      <engine n="4">
	<status-hud type="string">O</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
      <engine n="5">
	<status-hud type="string">o</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
      <engine n="6">
	<status-hud type="string">o</status-hud>
	<ignited-hud type="string"> </ignited-hud>
      </engine>
    </engines>
  </controls>
    
  <instrumentation>
    <doors>
      <door1>
	<position-norm type="float">1</position-norm>
      </door1>
    </doors>
    <robotarm-norm type="float">0</robotarm-norm> 
   </instrumentation>
 
 
 
 
 <sim>
  <description>NASA Space Shuttle Atlantis</description>
  <flight-model>jsb</flight-model>
  <aero>shuttle</aero>
  <author>Thorsten Renk (flight dynamics), NASA and HerbyW (3D)</author>
 

<!-- only SSME can be throttled initially, later throttle control is transferred to OMS -->

  <input>
    <selected>
      <engine n = "0" type="bool">1</engine>
      <engine n = "1" type="bool">1</engine>
      <engine n = "2" type="bool">1</engine>
      <engine n = "3" type="bool">0</engine>
      <engine n = "4" type="bool">0</engine>
      <engine n = "5" type="bool">0</engine>
      <engine n = "6" type="bool">0</engine>
      <engine n = "7" type="bool">0</engine>
      <engine n = "8" type="bool">0</engine>
      <engine n = "9" type="bool">0</engine>
      <engine n = "10" type="bool">0</engine>
      <engine n = "11" type="bool">0</engine>
      <engine n = "12" type="bool">0</engine>
      <engine n = "13" type="bool">0</engine>  
      <engine n = "14" type="bool">0</engine> 
      <engine n = "15" type="bool">0</engine>
      <engine n = "16" type="bool">0</engine>
      <engine n = "17" type="bool">0</engine>
      <engine n = "18" type="bool">0</engine>  
      <engine n = "19" type="bool">0</engine> 
      <engine n = "20" type="bool">0</engine>  
      <engine n = "21" type="bool">0</engine> 
    </selected>
    </input>
    

	
<multiplay>
   <chat_display>1</chat_display>
     <generic> 
        <float n="1" alias="/engines/engine[3]/thrust_lb" />
        <float n="2" alias="/engines/engine[1]/thrust_lb" />
        <float n="3" alias="/instrumentation/doors/door1/position-norm" />        
        <float n="4" alias="/consumables/fuel/tank/level-lbs" />
	<float n="5" alias="/consumables/fuel/tank[1]/level-lbs" />
	<float n="6" alias="/consumables/fuel/tank[2]/level-lbs" />
	<float n="7" alias="/engines/engine[4]/thrust_lb" />
        <float n="8" alias="/engines/engine[5]/thrust_lb" />
        <float n="9" alias="/engines/engine[6]/thrust_lb" />	
	<float n="10" alias="/consumables/fuel/tank[3]/level-lbs" />
	<float n="11" alias="/consumables/fuel/tank[4]/level-lbs" />                
        <float n="12" alias="/engines/engine[0]/thrust_lb" />        
        <float n="13" alias="/velocities/mach" />
    <!--<float n="14" alias="/engines/engine[8]/thrust_lb" />-->
        <float n="15" alias="/engines/engine[9]/thrust_lb" />
        <float n="16" alias="/engines/engine[10]/thrust_lb" />        
        <float n="17" alias="/engines/engine[11]/thrust_lb" />
        <float n="18" alias="/engines/engine[2]/thrust_lb" />
        <float n="19" alias="/instrumentation/robotarm-norm" />
        <float n="0" alias="/gear/gear/rollspeed-ms" />
       
        <int type="int" n="3" alias="/controls/shuttle/parachute"/>
        <int type="int" n="4" alias="/controls/shuttle/EMU"/>
        <int type="int" n="5" alias="/controls/shuttle/EMU"/>
        <int type="int" n="6" alias="/controls/shuttle/external-fuel-tank"/>
        <int type="int" n="7" alias="/controls/shuttle/solid-rocket-boosters"/>
        <int type="int" n="8" alias="/controls/lighting/nav-lights"/>
        <int type="int" n="9" alias="/controls/armament/trigger"/>        
     </generic>
</multiplay>

        <startup>
		<splash-texture>Aircraft/SpaceShuttle/shuttle_Earthview.png</splash-texture>
	</startup>
  
  <model>
	<path>Aircraft/SpaceShuttle/Models/SpaceShuttle.xml</path>		
  </model>
  
  <sound>
        <path>Aircraft/SpaceShuttle/Sounds/SpaceShuttle-Sounds.xml</path>
  </sound>

  <submodels>
      <serviceable type="bool">true</serviceable>
      <path>Aircraft/SpaceShuttle/Models/EMU/submodels.xml</path>
    </submodels>
  
 
	
  <view n="0">
   <internal archive="y">true</internal>
   <config>
    <x-offset-m archive="y" type="double">0</x-offset-m>
    <y-offset-m archive="y" type="double">4.94</y-offset-m>
    <z-offset-m archive="y" type="double">-32.5</z-offset-m>
   </config>
</view>

<chase-distance-m type="double" archive="y">-65.0</chase-distance-m>

<help>
      <title>Space Shuttle</title>


<key>
	<name>c</name>
	<desc>deploy drag chute</desc>
</key>
<key>
	<name>d</name>
	<desc>drop external tank</desc>
</key>
<key>
	<name>m</name>
	<desc>switch RCS rotation/translation</desc>
</key>
<key>
	<name>s</name>
	<desc>deploy speed brake</desc>
</key>
<key>
	<name>Keypad 4</name>
	<desc>RCS roll left</desc>
</key>
<key>
	<name>Keypad 6</name>
	<desc>RCS roll right</desc>
</key>
<key>
	<name>Keypad 8</name>
	<desc>RCS pitch down</desc>
</key>
<key>
	<name>Keypad 2</name>
	<desc>RCS pitch up</desc>
</key>
<key>
	<name>Keypad 5</name>
	<desc>RCS off</desc>
</key>
<key>
	<name>[</name>
	<desc>RCS yaw left</desc>
</key>
<key>
	<name>]</name>
	<desc>RCS yaw right</desc>
</key>
<text>

Put into launch position using --altitude=214 --pitch=90, into orbit using --altitude=500000 --uBody=27400, these exist also as presets SpaceShuttle-launch-set and SpaceShuttle-orbit-set.

Currently the flight dynamics is tested only for launch and orbital maneuvering, entry and landing will most likely not work properly!

Ignition sequence
=================

Ignition of the main engines is done via throttle - SSME 1 to 3 ignite as soon as the throttle reaches 65%. This is not enough to achieve liftoff for the normal launch mass of the shutte, however main engine ignition triggers SRB ignition three seconds later. Once both SRBs ignite, the shuttle will lift off the path rapidly.

Initial launch
==============

Upon ascent, the shuttle is controlled via thrust vectoring of both SSME and SRB. Initially, with the strong SRB thrusters far from the CoG, the launch stack is very maneuverable - don't get used to it.

Once clearing the pad, rotate to the desired launch course, then pull the launch stack gently out of the vertical to an about 70 degree inverted climb (the ride into orbit is done head down...). The external tank is very top-heavy (most of its mass is in the oxygen tank on its top) - take care that the stack doesn't topple too far out of the vertical, or you will never recover. Initially aerodynamical forces on the orbiter will require sizable thrust vectoring, as you clear the atmosphere the need will gradually go away as the flight control systems automatically vector each engine through the CoG.

SRB thrust can not be throttled, however the main engine can, and you will see a callout to throttle back the main engine to 65% after 34 seconds to avoid the highest dynamical pressure during ascent to damage the vehicle (damage is currently not modeled).

SRB separation
==============

SRBs will burn about 128 seconds before they are disconnected. At this point you should be on your launch course, out of the atmosphere at around 200.000 ft and still on a 70 degree climb. Once the SRBs connect, most of your thrust will be gone and since the main engines are very close to the central axis, thrust vectoring efficiency will be dramatically reduced.

In addition, you are not in vacuum, so any yaw, pitch or roll motion will continue indefinitely till it is countered by opposite thrust. The most important thing is to stay on your launch course - if you get a strong yaw drift, you will never make orbit.

Roll the orbiter out of inverted position, decrease climbing angle to 30-40 degrees and try to hold launch course and climb. Watch vertical speed and altitude - pull up once vertical speed starts to reduce to zero to maintain current altitude, don't worry if you start dropping for a minute, if you manage to reach orbital speed it won't matter. Try to level off at about 650.000 ft. 

Orbital insertion
=================

If you managed to control launch course and climb, after a few minutes, velocity over ground should climb to 7 km/s. As the tank empties, thrust gets more powerful again, watch g-forces and throttle back as needed to keep the load below 3 g. Eventually you should see the periapsis coming up above zero, meaning that you are about to reach orbit (there'll be another callout). Timing is critical, watch the apoapsis till it reaches the orbital altitude you want to reach, then cut thrust fast and drop the external tank.

Orbital maneuvering
===================

(You can start at this phase with --aircraft=SpaceShuttle-orbit)

Controls now switch to the reaction control system (RCS). Best use the keys to fire thrusters, 5 to cut thrust. Watch yaw, pitch and roll rates in the HUD. Do not leave controls uncentered at any point after maneuvering, not even a bit, you will regret it!

4: roll left
6: roll right
2: pitch up
8: pitch down
[: yaw left
]: yaw right
5: cut thrust

Your apoapsis should be where you want to go (say 650 km), your periapsis about where you are (say 240 km). Use the RCS to align the shuttle with the flightpath ('prograde orientation'). Wait till your altitude rises to the apoapsis, then lower the nose about 15 degrees below the flightpath (the OMS thrusters are located fairly high at the rear fuselage, so to align thrust through the CoG with the flightpath, the nose needs to be down) and use thrust control to ignite the OMS engines for a few minutes. Watch the periapsis value climb till it reaches the apoapsis value - congratulations, you've reached a circular orbit.

The RCS can also be used in translation mode, switching between modes is done using the 'm' key. In translational mode, the key mapping is

4: left
6: right
2: down
8: up
[: backward
]: forward
5: cut thrust

Without a visual reference point, the effect of translational thruster firings are hard to gauge.

De-orbiting
===========

Orient the shuttle 180 degrees to the flightpath using the RCS ('retrograde') and ignite the OMS engines about 5000 miles prior to your desired landing area. Observe the drop of the periapsis, continue the burn till the periapsis has reached zero. Orient the shuttle prograde and pitch up to 40 degrees.

The vertical velocity will now build rapidly as the Shuttle is on a descending ballistic trajectory. The first signs of the atmosphere will be felt at around 400.000 ft altitude, which is known as the entry interface ('EI').

Entry
=====

(You can start at this phase with --aircraft=SpaceShuttle-entry)

The atmosphere drag will cause a tendency for the Shuttle to pitch down - use the RCS to counter that tendency, maintaining 40 degrees pitch angle is crucial. As aerodynamical forces increase, control authority for roll, pitch and yaw will gradually be transferred to aerodynamical surfaces, resulting in callouts.

Lift will finally be produced and slow the vertical motion - this will keep nose temperature and deceleration g-load within acceptable limits. Once the descent stops, you need to make sure the shuttle doesn't bounce and reduce lift. Do not reduce pitch (AoA) as you would usually do or you will burn. Rather, roll the shuttle to a high bank-angle (up to 70 degrees) maintaining high AoA.

Use symmetric high bank angle maneuvers ('roll reversals') if you want to stay on your ground track, asymmetric ones if you want to aim your ground track to the landing site. The amount of high bank angle flown dictates descent rate and hence deceleration and thermal load - use this to manage your entry trajectory (the full theory is too complex to squeeze this into here).

Aim and manage the entry trajectory into the TAEM interface.

Terminal Area Energy Management
===============================

(You can start at this phase with --aircraft=SpaceShuttle-TAEM)

You should be about 60 miles from the landing site at 85.000 ft with Mach 2.5 and control is fully aerodynamical. Maintain a descent rate of about 10.000 ft/min, initially on a shallow glideslope, all the way slowing down. Overfly the landing site at about 49.000 ft transiting to subsonic velocities, continute to fly straight till about 32.000 to 36.000 ft (dependent on how much you expect to turn for heading alignment).

Turn around onto your landing course, glideslope should be -15 degrees, descent rate still 10.000 ft/min. You should reach 10.000 ft altitude about 7 miles from the runway.

Landing
=======

(You can start at this phase with --aircraft=SpaceShuttle-approach)

Descend with a glidepath of -17 to -15 deg, using speedbrakes to keep the velocity at around 320-340 kt. At 1.700 ft above ground, pull up and reduce glidepath to -3 deg, deploy gear, flare and aim for a touchdown at between 200 and 220 kt (you may need a long runway).

Once the nose wheel is on the ground, deploy drag chute using 'c' (it has two stages, the first stage is 40% reefed) and apply wheel brakes 'b' to bring the Shuttle to a stop. Congratulations, you're home.

</text>
</help>

 </sim>
 
<!-- Key mapping -->

 <input>
  <keyboard>

<key n="91">
  <name>[</name>
  <desc>Move rudder left</desc>
  <repeatable type="bool">true</repeatable>
  <binding>
   <command>property-adjust</command>
   <property>/controls/flight/rudder</property>
   <step type="double">-0.05</step>
  </binding>
 </key>

 <key n="93">
  <name>]</name>
  <desc>Move rudder right</desc>
  <repeatable type="bool">true</repeatable>
  <binding>
   <command>property-adjust</command>
   <property>/controls/flight/rudder</property>
   <step type="double">0.05</step>
  </binding>
 </key>

 <key n="99">
   <name>c</name>
   <desc>Deploy drag chute</desc>  
          <binding>
            <command>nasal</command>
            <script>SpaceShuttle.deploy_chute()</script>
          </binding>	  
     </key>

 <key n="100">
  <name>d</name>
  <desc>Drop external tank</desc>
  <binding>
   <command>nasal</command>
   <script>SpaceShuttle.external_tank_separate()</script>
  </binding>
 </key>

 <key n="109">
  <name>m</name>
  <desc>RCS mode</desc>
  <repeatable type="bool">false</repeatable>
  <binding>
   <command>nasal</command>
   <script>SpaceShuttle.switch_control_mode()</script>
  </binding>
 </key>
    
    <key n="115">
	<name>s</name>
	<desc>Speedbreakes on Rudder, left and right</desc>
	<binding>
           <command>property-toggle</command>
             <property>controls/flight/speedbrake</property>
             <value>true</value>
        </binding>	
     </key>
     


   </keyboard>
  </input>                     
  

 <payload>
  <weight>
   <name type="string">Pilot</name>
   <weight-lb alias="/fdm/jsbsim/inertia/pointmass-weight-lbs[0]"/>
   <min-lb type="double">0.0</min-lb>
   <max-lb type="double">1200000.0</max-lb>
  </weight>
 </payload>


 
 <nasal>      
    <SpaceShuttle>
      <file>Aircraft/SpaceShuttle/Nasal/stages.nas</file>
      <file>Aircraft/SpaceShuttle/Nasal/dialogs.nas</file>
    </SpaceShuttle> 
    
  </nasal>

  <import>
        <path>Huds/Sets/controls.xml</path>
        <x-offset>-100</x-offset>
        <y-offset>70</y-offset>
    </import>
</PropertyList>


